(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[941],{3083:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/file-manager",function(){return n(7603)}])},7603:function(e,t,n){"use strict";n.r(t);var r=n(1860),i=n(9957),a=n(8520),s=n(3368),o=n(9405),c=n(4145),u=n(3766),l=n.n(u),d=n(3470),p=n(8491),h=n(7199),f=n(7720),m=n(1009),v=n(8385),x=n(8833),y=n(4627),b=n(7294),k=n(7645),g=n(4974),w=n(831),z=n(8711),S=n(565),C=n(3858),D=n(1731),I=n(6855),j=n(4464),P=n(7311),T=n(9228),q=n(1353),L=n(5384),N=n(1498),Z=n(7076),E=n(3115),F=n(4204),R=n.n(F),U=n(4348),M=n.n(U),W=n(6458),_=n.n(W),H=n(1348),K=n(7472),X=n(4937),A=n(8298);function O(e){return e.key=e.name,e}(0,j.Mg)();var J=(0,p.ZC)({name:{cursor:"pointer","&:hover":{textDecoration:"underline"}}}),Q=function(e,t){return e&&t?t((0,c.Z)((0,o.Z)({},e),{styles:(0,p.E$)(e.styles,{root:{paddingTop:0}})})):null};function Y(e,t){var n=e.toLocaleLowerCase().localeCompare(t.toLocaleLowerCase());return 0!==n?n:e.localeCompare(t)}var B=function(){function e(){var t=this;(0,a.Z)(this,e),this.initial=!0,this.visible=!1,this.path="/",this.loading=!1,this.items=[],this.sortKey="name",this.sortDescending=!1,this.uploading=!1,this.uploadPath=void 0,this.uploadedSize=0,this.uploadTotalSize=0,this.debouncedUploadedSize=0,this.uploadSpeed=0,this.selectedItems=[],this.contextMenuTarget=void 0,this.pushPathQuery=function(e){M().push({query:(0,c.Z)((0,o.Z)({},M().query),{path:e})})};var n=this;this.loadFiles=(0,A.FW)(function(){var e=(0,i.Z)(l().mark((function e(t){var i,a,s,o,c,u,d,p,h,f,m,v,x,y,b,k,g,w;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.path,(0,Z.z)((function(){return n.items=[]})),X.q.device){e.next=4;break}return e.abrupt("return");case 4:return(0,Z.z)((function(){return n.loading=!0})),e.next=7,X.q.device.sync();case 7:a=e.sent,s=[],o=[],c=setInterval((function(){t.aborted||(0,Z.z)((function(){return n.items=s.slice()}))}),1e3),e.prev=11,u=!1,d=!1,e.prev=13,h=(0,r.Z)(a.opendir(i));case 15:return e.next=17,h.next();case 17:if(!(u=!(f=e.sent).done)){e.next=28;break}if(m=f.value,v=m,!t.aborted){e.next=22;break}return e.abrupt("return");case 22:if("."!==v.name&&".."!==v.name){e.next=24;break}return e.abrupt("continue",25);case 24:v.type===L.d6.Link?o.push(v):s.push(O(v));case 25:u=!1,e.next=15;break;case 28:e.next=34;break;case 30:e.prev=30,e.t0=e.catch(13),d=!0,p=e.t0;case 34:if(e.prev=34,e.prev=35,!u||null==h.return){e.next=39;break}return e.next=39,h.return();case 39:if(e.prev=39,!d){e.next=42;break}throw p;case 42:return e.finish(39);case 43:return e.finish(34);case 44:x=!0,y=!1,b=void 0,e.prev=45,k=o[Symbol.iterator]();case 47:if(x=(g=k.next()).done){e.next=59;break}if(w=g.value,!t.aborted){e.next=51;break}return e.abrupt("return");case 51:return e.next=53,a.isDirectory(_().resolve(i,w.name));case 53:if(e.sent){e.next=55;break}w.mode=L.d6.File<<12|w.permission,w.size=0n;case 55:s.push(O(w));case 56:x=!0,e.next=47;break;case 59:e.next=65;break;case 61:e.prev=61,e.t1=e.catch(45),y=!0,b=e.t1;case 65:e.prev=65,e.prev=66,x||null==k.return||k.return();case 68:if(e.prev=68,!y){e.next=71;break}throw b;case 71:return e.finish(68);case 72:return e.finish(65);case 73:if(!t.aborted){e.next=75;break}return e.abrupt("return");case 75:(0,Z.z)((function(){return n.items=s}));case 76:return e.prev=76,t.aborted||(0,Z.z)((function(){return n.loading=!1})),clearInterval(c),a.dispose(),e.finish(76);case 81:case"end":return e.stop()}}),e,null,[[11,,76,81],[13,30,34,44],[35,,39,43],[45,61,65,73],[66,,68,72]])})));return function(t){return e.apply(this,arguments)}}());var s=this;this.upload=function(){var e=(0,i.Z)(l().mark((function e(t){var n,r,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.q.device.sync();case 2:return n=e.sent,e.prev=3,r=_().resolve(s.path,t.name),(0,Z.z)((function(){s.uploading=!0,s.uploadPath=t.name,s.uploadedSize=0,s.uploadTotalSize=t.size,s.debouncedUploadedSize=0,s.uploadSpeed=0})),i=setInterval((0,Z.aD)((function(){s.uploadSpeed=s.uploadedSize-s.debouncedUploadedSize,s.debouncedUploadedSize=s.uploadedSize})),1e3),e.prev=7,e.next=10,(0,A.Xd)(t).pipeThrough(new N.Cc(L.j4)).pipeThrough(new A.hK((0,Z.aD)((function(e){s.uploadedSize=e})))).pipeTo(n.write(r,L.d6.File<<12|438,t.lastModified/1e3));case 10:(0,Z.z)((function(){s.uploadSpeed=s.uploadedSize-s.debouncedUploadedSize,s.debouncedUploadedSize=s.uploadedSize}));case 11:return e.prev=11,clearInterval(i),e.finish(11);case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(3),X.q.showErrorDialog(e.t0);case 19:return e.prev=19,n.dispose(),s.loadFiles(),(0,Z.z)((function(){s.uploading=!1})),e.finish(19);case 24:case"end":return e.stop()}}),e,null,[[3,16,19,24],[7,,11,14]])})));return function(t){return e.apply(this,arguments)}}(),(0,Z.ky)(this,{initial:!1,items:Z.LO.shallow,pushPathQuery:!1,changeDirectory:Z.aD.bound,loadFiles:!1}),(0,Z.EH)((function(){X.q.device?t.initial&&t.visible&&(t.initial=!1,t.loadFiles()):t.initial=!0}))}return e.prototype.changeDirectory=function(e){this.path!==e&&(this.path=e,X.q.device&&this.loadFiles())},(0,s.Z)(e,[{key:"breadcrumbItems",get:function(){var e=this,t="",n=this.path.split("/").filter(Boolean).map((function(n){var r=e;return{key:t+="/"+n,text:n,onClick:function(e,t){t&&r.pushPathQuery(t.key)}}}));return n.unshift({key:"/",text:"Device",onClick:function(){return e.pushPathQuery("/")}}),n[n.length-1].isCurrentItem=!0,delete n[n.length-1].onClick,n}},{key:"menuItems",get:function(){var e=[];switch(this.selectedItems.length){case 0:var t=this;e.push({key:"upload",text:"Upload",iconProps:{iconName:A.PJ.CloudArrowUp,style:{height:20,fontSize:20,lineHeight:1.5}},disabled:!X.q.device,onClick:function(){var e=t;return(0,i.Z)(l().mark((function t(){var n,r,i;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,A.oT)({multiple:!0});case 2:n=t.sent,r=0;case 4:if(!(r<n.length)){t.next=11;break}return i=n.item(r),t.next=8,e.upload(i);case 8:r++,t.next=4;break;case 11:case"end":return t.stop()}}),t)})))(),!1}});break;case 1:if(this.selectedItems[0].type===L.d6.File){var n=this;e.push({key:"download",text:"Download",iconProps:{iconName:A.PJ.CloudArrowDown,style:{height:20,fontSize:20,lineHeight:1.5}},onClick:function(){var e=n;return(0,i.Z)(l().mark((function t(){var n,r,i;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,X.q.device.sync();case 2:return n=t.sent,t.prev=3,r=e.selectedItems[0],i=_().resolve(e.path,r.name),t.next=8,n.read(i).pipeTo((0,A.yH)(r.name,Number(r.size)));case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(3),X.q.showErrorDialog(t.t0);case 13:return t.prev=13,n.dispose(),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[3,10,13,16]])})))(),!1}})}default:var r=this;e.push({key:"delete",text:"Delete",iconProps:{iconName:A.PJ.Delete,style:{height:20,fontSize:20,lineHeight:1.5}},onClick:function(){var e=r;return(0,i.Z)(l().mark((function t(){var n,r,i,a,s,o,c;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,n=!0,r=!1,i=void 0,t.prev=2,a=e.selectedItems[Symbol.iterator]();case 4:if(n=(s=a.next()).done){t.next=15;break}return o=s.value,t.next=8,X.q.device.rm(_().resolve(e.path,o.name));case 8:if(!(c=t.sent)){t.next=12;break}return X.q.showErrorDialog(c),t.abrupt("return");case 12:n=!0,t.next=4;break;case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(2),r=!0,i=t.t0;case 21:t.prev=21,t.prev=22,n||null==a.return||a.return();case 24:if(t.prev=24,!r){t.next=27;break}throw i;case 27:return t.finish(24);case 28:return t.finish(21);case 29:t.next=34;break;case 31:t.prev=31,t.t1=t.catch(0),X.q.showErrorDialog(t.t1);case 34:return t.prev=34,e.loadFiles(),t.finish(34);case 37:case"end":return t.stop()}}),t,null,[[0,31,34,37],[2,17,21,29],[22,,24,28]])})))(),!1}})}return e}},{key:"sortedList",get:function(){var e=this,t=this.items.slice();return t.sort((function(t,n){var r,i=t.type===L.d6.File?1:0,a=n.type===L.d6.File?1:0;if(i!==a)r=i-a;else{var s=t[e.sortKey],o=n[e.sortKey];r=s===o?Y(t.name,n.name):"string"===typeof s?Y(s,o):s<o?-1:1}return e.sortDescending&&(r*=-1),r})),t}},{key:"columns",get:function(){var e,t,n=[{key:"type",name:"File Type",iconName:A.PJ.Document20,isIconOnly:!0,minWidth:20,maxWidth:20,isCollapsible:!0,onRender:function(e){var t;switch(e.type){case L.d6.Link:t=(0,P.EX)({type:T.I.linkedFolder}).iconName;break;case L.d6.Directory:t=(0,P.EX)({type:T.I.folder}).iconName;break;case L.d6.File:t=(0,P.EX)({extension:_().extname(e.name)}).iconName;break;default:t=(0,P.EX)({extension:"txt"}).iconName}var n=(0,p.q7)(t).code.props.src;return(0,d.jsx)(h.J,{imageProps:{crossOrigin:"anonymous",src:n},style:{width:20,height:20}})}},{key:"name",name:"Name",minWidth:0,isRowHeader:!0,onRender:function(e){return(0,d.jsx)("span",{className:J.name,"data-selection-invoke":!0,children:e.name})}},{key:"permission",name:"Permission",minWidth:0,isCollapsible:!0,onRender:function(e){return"".concat((e.mode>>6&4).toString(8)).concat((e.mode>>3&4).toString(8)).concat((4&e.mode).toString(8))}},{key:"size",name:"Size",minWidth:0,isCollapsible:!0,onRender:function(e){return e.type===L.d6.File?(0,A.BU)(Number(e.size)):""}},{key:"mtime",name:"Last Modified Time",minWidth:150,isCollapsible:!0,onRender:function(e){return new Date(1e3*Number(e.mtime)).toLocaleString()}}];(null===(e=X.q.device)||void 0===e||null===(t=e.features)||void 0===t?void 0:t.includes(L.Pq.ListV2))&&n.push({key:"ctime",name:"Creation Time",minWidth:150,isCollapsible:!0,onRender:function(e){return new Date(1e3*Number(e.ctime)).toLocaleString()}},{key:"atime",name:"Last Access Time",minWidth:150,isCollapsible:!0,onRender:function(e){return new Date(1e3*Number(e.atime)).toLocaleString()}});var r=!0,i=!1,a=void 0;try{for(var s,o=n[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var c=s.value,u=this;c.onColumnClick=function(e,t){if(u.sortKey===t.key){var n=u;(0,Z.z)((function(){return n.sortDescending=!n.sortDescending}))}else{var r=u;(0,Z.z)((function(){r.sortKey=t.key,r.sortDescending=!1}))}},c.key===this.sortKey&&(c.isSorted=!0,c.isSortedDescending=this.sortDescending)}}catch(l){i=!0,a=l}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}}]),e}(),V=new B,$=(0,E.Pi)((function(){return(0,d.jsx)(f.V,{hidden:!V.uploading,dialogContentProps:{title:"Uploading...",subText:V.uploadPath},children:(0,d.jsx)(m.Y,{description:(0,A.CY)(V.debouncedUploadedSize,V.uploadTotalSize,V.uploadSpeed),percentComplete:V.uploadedSize/V.uploadTotalSize})})}));t.default=(0,E.Pi)((function(){(0,H.useEffect)((function(){return(0,Z.z)((function(){V.visible=!0})),function(){(0,Z.z)((function(){V.visible=!1}))}}));var e=(0,U.useRouter)();(0,H.useEffect)((function(){var t=e.query.path;t?(Array.isArray(t)&&(t=t[0]),V.changeDirectory(t)):e.replace({query:(0,c.Z)((0,o.Z)({},e.query),{path:V.path})})}),[e]);var t=(0,H.useState)(),n=t[0],r=t[1],a=(0,H.useCallback)(function(){var e=(0,i.Z)(l().mark((function e(t){var n,i,a,s,o;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.q.device.sync();case 2:return n=e.sent,e.prev=3,i=n.read(t),a=new Response(i),e.next=8,a.blob();case 8:s=e.sent,o=window.URL.createObjectURL(s),r(o);case 11:return e.prev=11,n.dispose(),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[3,,11,14]])})));return function(t){return e.apply(this,arguments)}}(),[]),s=(0,H.useCallback)((function(){r(void 0)}),[]),u=(0,H.useCallback)((function(e){switch(e.type){case L.d6.Link:case L.d6.Directory:V.pushPathQuery(_().resolve(V.path,e.name));break;case L.d6.File:switch(_().extname(e.name)){case".jpg":case".png":case".svg":case".gif":a(_().resolve(V.path,e.name))}}}),[a]),p=(0,q.B)((function(){return new v.Y({onSelectionChanged:function(){(0,Z.z)((function(){V.selectedItems=p.getSelection()}))}})})),h=(0,H.useCallback)((function(e,t,n){return!!n&&(V.menuItems.length&&(0,Z.z)((function(){V.contextMenuTarget=n})),!1)}),[]),f=(0,H.useCallback)((function(){(0,Z.z)((function(){return V.contextMenuTarget=void 0}))}),[]);return(0,d.jsxs)(x.K,(0,c.Z)((0,o.Z)({},A.LE),{children:[(0,d.jsx)(R(),{children:(0,d.jsx)("title",{children:"File Manager - Android Web Toolbox"})}),(0,d.jsx)(K.X3,{items:V.menuItems}),(0,d.jsx)(y.a,{items:V.breadcrumbItems}),(0,d.jsxs)(b.v,{grow:!0,styles:{root:{margin:"-8px -16px -16px -16px",padding:"8px 16px 16px 16px",overflowY:"auto"}},children:[(0,d.jsx)(k.x,{selection:p,children:(0,d.jsx)(g.J,{items:V.sortedList,columns:V.columns,setKey:V.path,selection:p,layoutMode:w.Oh.justified,enableShimmer:V.loading&&0===V.items.length,onItemInvoked:u,onItemContextMenu:h,onRenderDetailsHeader:Q,usePageCache:!0,useReducedRowRenderer:!0})}),n&&(0,d.jsx)(z.m,{children:(0,d.jsx)(S.a,{onClick:s,children:(0,d.jsx)("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,d.jsx)("img",{src:n,alt:"",style:{maxWidth:"100%",maxHeight:"100%"}})})})})]}),(0,d.jsx)(K.ag,{children:(0,d.jsx)(C.r,{items:V.menuItems,hidden:!V.contextMenuTarget,directionalHint:D.b.bottomLeftEdge,target:V.contextMenuTarget,onDismiss:f,contextualMenuItemAs:function(e){return(0,d.jsx)(I.W,(0,c.Z)((0,o.Z)({},e),{hasIcons:!1}))}})}),(0,d.jsx)($,{})]}))}))}},function(e){e.O(0,[743,774,888,179],(function(){return t=3083,e(e.s=t);var t}));var t=e.O();_N_E=t}]);
//# sourceMappingURL=file-manager-7316e1b0e1422ebc.js.map